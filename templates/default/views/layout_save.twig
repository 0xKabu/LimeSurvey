{#
    LimeSurvey
    Copyright (C) 2007-2017 The LimeSurvey Project Team / Louis Gac
    All rights reserved.
    License: GNU/GPL License v2 or later, see LICENSE.php
    LimeSurvey is free software. This version may have been modified pursuant
    to the GNU General Public License, and as distributed it includes or
    is derivative of works licensed under the GNU General Public License or
    other free or open source software licenses.
    See COPYRIGHT.php for copyright notices and details.
#}
<!DOCTYPE html>
<html lang="{{ aSurveyInfo.languagecode }}" dir="{{ aSurveyInfo.dir }}" class="no-js {{ aSurveyInfo.languagecode }} dir-{{ aSurveyInfo.dir }} ">

    {# Headers, metadatas, etc #}
    {{ include('./subviews/head.twig') }}

    <body class="default lang-{{surveylanguage}} {{surveyformat}}">

        {# Bootstrap Navigation Bar: the top menu #}
        {{ include('./subviews/nav_bar.twig') }}

        <!-- Outer Frame Container -->
        <div class="outerframe container" id="outerframeContainer">

            <!-- Main Row -->
            <div id="main-row">
                <!-- Main Col -->
                <div class="col-centered" id="main-col">

                    {# include the various Warnings (preview mode, unanswered mandatory questions, etc) #}
                    {{ include('./subviews/warnings.twig') }}

                    {# include the form opening tag #}
                    {{ include('./subviews/start_form.twig') }} <!-- main form -->

                        {# This will display the script and the hidden inputs needed for Expression Manager #}
                        {{ aSurveyInfo.EM.ScriptsAndHiddenInputs  }}

                        <div class="well clearfix save-message">
                            <div class="h2">{{ "Save your unfinished survey" | t }}</div>
                            <div class="text-info">
                                <p> {{ "Enter a name and password for this survey and click save below." | t }} </p>
                                <p> {{ "Your survey will be saved using that name and password, and can be completed later by logging in with the same name and password." | t }} </p>
                                <p class='info-email-optional ls-info'> {{ "If you give an email address, an email containing the details will be sent to you." | t }} </p>
                                <p> {{ "After having clicked the save button you can either close this browser window or continue filling out the survey." | t }} </p>
                            </div>
                            <div class="text-warning">
                                <p> {{ "To remain anonymous please use a pseudonym as your username, also an email address is not required." | t }} </p>
                            </div>
                        </div>

                        <div class="save-form">

                            {% if count(aSurveyInfo.aSaveForm.aErrors) > 0 %}
                                <ul class='{{ aSurveyInfo.aSaveForm.sClass }} alert alert-danger list-unstyled' role='alert'>
                                    {% for key,error in aSurveyInfo.aSaveForm.aErrors %}
                                        <li>{{ error }}</li>
                                        {% endfor %}
                                </ul>
                            {% endif %}

                            {#
                                array of attributes of the form tag.
                                To add a new attribute, just add an entry:
                                'attribute' : 'value',
                            #}
                            {% set htmlOptions = {
                                    'id'          : 'form-save',
                                    'name'        : 'form-save',
                                    'class'       : 'ls-form',
                                }
                            %}

                            <!-- Save Form -->
                            {{
                                C.Html.form(
                                    ( aSurveyInfo.surveyUrl ),
                                    'post',
                                    (htmlOptions)
                                )
                            }}
                                <!-- Name and Password -->
                                <div class='save-survey-form form-horizontal'>
                                    <div class='form-group save-survey-row save-survey-name'>

                                        <!-- Saved name  -->
                                        <label class='control-label col-sm-3 save-survey-label' for='savename'>
                                            {{ "Saved name:" | t }}
                                        </label>
                                        <div class='col-sm-7 save-survey-input input-cell'>

                                            {% set htmlOptions = {
                                                    'id'          : 'savename',
                                                    'name'        : 'savename',
                                                    'class'       : 'form-control',
                                                    'required'    : true,
                                                }
                                            %}

                                            {# using CHtml::textField because it encode (and break XSS) #}
                                            {{ C.Html.textField(
                                                    'savename',
                                                    getPost('savename'),
                                                    (htmlOptions)
                                            )  }}
                                        </div>
                                    </div>

                                    <!-- Password -->
                                    <div class='form-group save-survey-row save-survey-password'>
                                        <label class='control-label col-sm-3 save-survey-label label-cell' for='savepass'>
                                            {{ "Password:" | t }}
                                        </label>

                                        <div class='col-sm-7 save-survey-input input-cell'>

                                            {% set htmlOptions = {
                                                    'id'          : 'savepass',
                                                    'name'        : 'savepass',
                                                    'class'       : 'form-control',
                                                    'required'    : true,
                                                }
                                            %}

                                            {{ C.Html.passwordField(
                                                    'savepass',
                                                    '',
                                                    (htmlOptions)
                                            )  }}
                                        </div>
                                    </div>

                                    <!-- Confirm password -->
                                    <div class='form-group save-survey-row save-survey-password'>
                                        <label class='control-label col-sm-3 save-survey-label label-cell' for='savepass2'>
                                            {{ "Repeat password:" | t }}
                                        </label>

                                        <div class='col-sm-7 save-survey-input input-cell'>
                                            {% set htmlOptions = {
                                                    'id'          : 'savepass2',
                                                    'name'        : 'savepass2',
                                                    'class'       : 'form-control',
                                                    'required'    : true,
                                                }
                                            %}

                                            {{ C.Html.passwordField(
                                                    'savepass2',
                                                    '',
                                                    (htmlOptions)
                                            )  }}
                                        </div>
                                    </div>

                                    <!-- Email -->
                                    <div class='form-group save-survey-row save-survey-password'>
                                        <label class='control-label col-sm-3 save-survey-label label-cell' for='saveemail'>
                                            {{ "Your email address:" | t }}
                                        </label>
                                        <div class='col-sm-7 save-survey-input input-cell'>

                                            {% set htmlOptions = {
                                                    'id'          : 'saveemail',
                                                    'name'        : 'saveemail',
                                                    'class'       : 'form-control',
                                                }
                                            %}

                                            {{ C.Html.emailField(
                                                    'saveemail',
                                                    '',
                                                    (htmlOptions)
                                            )  }}
                                        </div>
                                    </div>


                                    {% if aSurveyInfo.aSaveForm.aCaptcha.show %}
                                        <!-- Captcha -->
                                        <div class='form-group save-survey-row save-survey-captcha'>
                                            <label class='control-label col-sm-3 save-survey-label label-cell' for='loadsecurity'>
                                                {{ "Security question:" | t }}
                                            </label>
                                            <div class='col-sm-7 save-survey-input input-cell'>
                                                <div class='input-group'>
                                                    <div class='input-group-addon captcha-image' >
                                                        <img src='{{ aSurveyInfo.aSaveForm.aCaptcha.sImageUrl }}' alt='captcha' />
                                                    </div>
                                                    <input class='form-control' type='text' size='5' maxlength='3' id='loadsecurity' name='loadsecurity' value='' alt=''/>
                                                </div>
                                            </div>
                                        </div>
                                    {% endif %}

                                    <!-- save button -->
                                    <div class='form-group save-survey-row save-survey-submit'>
                                        <div class='col-sm-7 col-md-offset-3 save-survey-input input-cell'>
                                            <button type='submit' id='savebutton' name="savesubmit" class='btn btn-default' value='save'>
                                                {{ "Save Now" | t }}
                                            </button>
                                        </div>
                                    </div>
                                </div>


                            <div class='return-to-survey'>
                                <div class="url-wrapper url-wrapper-survey-return">
                                    <a href="{{ aSurveyInfo.surveyUrl }}" class="ls-return">{{ "Return to survey" }}</a>
                                </div>
                            </div>
                        </div>

                    </form> <!-- main form -->
                </div> <!-- main col -->
            </div> <!-- main row -->
        </div> <!-- outer frame container -->

        {# Bootstrap alert modal #}
        {{ include('./subviews/bootstrap_alert_modal.twig') }}

        <!-- some template.js function launched before ready -->
        <script type="text/javascript">
        /*<![CDATA[*/
            sliderSuffixClone();
            fixBodyPadding();
            hideQuestionWithRelevanceSubQuestion();
            hideEmptyPart();
        /*]]>*/
        </script>
    </body>
</html>
<!-- end of startpage.twig -->
